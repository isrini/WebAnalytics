Shrek the Third is a 2007 American computer-animated fantasy comedy film and the third installment in the Shrek franchise, produced by DreamWorks Animation. It is the sequel to 2004's Shrek 2, and is the first in the series to be distributed by Paramount Pictures1, which acquired DreamWorks Pictures, the former parent of DreamWorks Animation, in 2006. Chris Miller and Raman Hui directed and co-directed the film, respectively,[2] with the former also co-writing the screenplay with Jeffrey Price, Peter S. Seaman, and Aron Warner. In addition to Mike Myers, Eddie Murphy, Cameron Diaz, Antonio Banderas, Rupert Everett, Julie Andrews, and John Cleese, who reprise their roles from Shrek 2, the film also features Justin Timberlake in the role of Arthur Pendragon and Eric Idle as Merlin. Harry Gregson-Williams composed the original music for the film. The story takes place eight months after the marriage of Shrek and Fiona in the first film.[3] Reluctantly reigning over the kingdom of Far, Far Away, Shrek sets out to find the next heir to the throneâ€”Fiona's cousin Artie, while Prince Charming is plotting to overthrow Shrek and become king.Prince Charming vows that he will become King of Far, Far Away and avenge the death of his mother, the Fairy Godmother. Meanwhile, King Harold is dying and his ogre son-in-law Shrek and daughter Princess Fiona are to succeed him. Shrek's attempts at trying to serve as the Regent during the King's medical leave end in disaster, and insists that an ogre as king is a bad idea and that there must be someone else to rule the kingdom. Before dying, Harold tells Shrek of another heir: his nephew, Arthur Pendragon. Prince Charming goes to the Poison Apple tavern and persuades fairy tale villains to fight for their "happily ever after" by appealing to the defeats given in their stories.Shrek, Donkey and Puss in Boots set out to retrieve Arthur; as they are sailing away, Fiona yells to Shrek that she is pregnant. The trio journey to Worcestershire Academy, an elite magical boarding school, where they discover Arthur, so-called "Artie", is a scrawny 16-year-old underachiever picked on by everyone. At the school pep rally, Shrek tells Artie he is going to be king of Far Far Away. Artie is excited until Donkey and Puss inadvertently frighten him by discussing the responsibilities of being king. Artie tries taking control of the ship and crashes it on a remote island, where they meet Artie's retired wizard teacher, Merlin.Meanwhile, Charming and the other villains attack the castle, but Wolfie, Pinocchio, Gingy, the Three Little Pigs and the Blind Mice stall them long enough for Fiona and her mother Queen Lillian to escape along with Snow White, Rapunzel, Cinderella, Sleeping Beauty and Doris the Ugly Stepsister. One of the Pigs accidentally blurts out that Shrek has gone to retrieve Arthur, and Prince Charming sends Captain Hook and his pirates to track down Shrek. The ladies are put in a tower when Rapunzel betrays them because she loves Charming.Captain Hook and his pirates track Shrek and his friends to Merlin's island, where they attempt to capture Shrek alive and defeat the others. Shrek and Artie defeat the villains, and Hook mentions Charming and the takeover of Far Far Away. Concerned for his wife and future child, Shrek urges Artie to return to Worcestershire. Instead, Artie cons Merlin into using his magic to send them to Far Far Away. The spell works, but causes Puss and Donkey to accidentally switch bodies. They find Pinocchio and learn that Charming plans to kill Shrek as part of a play. Charming's men arrive, but Artie tricks the knights into not taking them into custody and they break into the castle during rehearsals for the play. Caught in Charming's dressing room, the four are taken captive.Charming prepares to kill Artie, believing he is the next king. To save Artie's life, Shrek tells Charming that Artie was a pawn to take his place as King of Far Far Away. Charming believes Shrek and allows Artie to leave. Donkey and Puss are imprisoned with Fiona and the ladies, where Fiona grows frustrated with their lack of initiative. Queen Lillian smashes an opening in the stone wall of the prison with a head butt. While the princesses launch a rescue mission for Shrek, Donkey and Puss free Gingy, Pinocchio, the wolf and pigs, Dragon and Donkey's children. They encounter Artie, still angry, but Puss and Donkey mollify him by explaining that Shrek lied to Charming to save Artie's life.By nightfall, Charming stages a musical in front of the kingdom. Just as Charming is about to kill Shrek, Fiona, along with Puss, Donkey, the princesses and the fairy tale characters confront the villains. Artie convinces the villains that just because they are being treated like losers does not mean that they have to be losers.Touched by Artie's speech, all the villains agree to give up their evil ways. Except for an infuriated Charming, who lunges at Artie with his sword, but Shrek blocks the blow, so Charming attacks him instead. Shrek, who seems fatally injured, informs Charming that he needs to work on his aim and that the Prince needs to keep looking for his own happily ever after. As Shrek pushes him aside, Dragon knocks Rapunzel's tower on Charming crushing him to his death. Artie is then crowned king, and takes the throne. While the kingdom celebrates, Merlin restores Puss and Donkey to their proper bodies, accidentally switching their tails temporarily. Shrek returns home to the swamp with Fiona, becoming the parents of ogre triplets.